135000*1.07
135000*1.0748
135000*1.05
8737+10000+12387+8299++4088
8737+10000+12387+8299+4088
143000*1.15
135000*1.05
143000*1.05
143000*1.02
145000*1.05
145000*0.05
143000*0.05
143000*0.03„ÄÅ
143000*0.03
0.15*360
14+14/3
str(geno_case_matrix)
snp_dat <- ALS_data_SNV_no_LoF_euro%>%
dplyr::select(c("Sample.Type","ID","subRVIS.Domain.Name",
"chrno","loc_adj"))%>%
dplyr::rename(Sample.Name=ID)
snp_dat <- analysis_Euro_dt%>%dplyr::rename(Sample.Name=ID)
Gmat_case=geno_case_matrix
Gmat_ctrl=geno_ctrl_matrix
View(A)
check <- ALS_data_SNV %>% dplyr::select(c("Sample.Name","Sample.Type"))%>%
distinct_all()
setwd("/Users/xuechan/Documents/Study/Rotation-Jichun/project_1/DART_Code_last/Simulation")
rm(list=ls())
library(ape)
library(cubature)
library(foreach)
library(doParallel)
library("doRNG")
library(xtable)
library(tidyverse)
library("MASS")
library(survival)
source("../DART_function.R")
source("../FDRL_function.R")
nsim=200
# function to generate the hypotheses locations
nodes.2D.simu <- function(ntips){
d1 <- rnorm(ntips,0,2)
d2 <- runif(ntips,0,4)
return(cbind(d1,d2))
}
# Generate tree and corresponding aggregation tree
set.seed(123)
ntip=1000;n=300
toy <- nodes.2D.simu(ntip)
ceiling(log(ntip/50,3))
grids <- c(56,96)
snm <- sqrt(n*log(ntip)*log(log(ntip)))
Dist0 <- as.matrix(dist(toy))
head(toy)
library(ggplot2)
str(toy)
Dist0 <- as.matrix(dist(toy))
b11 <- pmax(dnorm(Dist0[156,],0,0.8)*3.4-0.8,0)
b12 <- dnorm(Dist0[7,],0,0.05)*3
b13 <- -dnorm(Dist0[90,],0,0.15)*2
b1 <- (b11+b12)
b1[c(300,200,400,100,500,600,700,800,900,1000)] <- 10
eta1 <- ifelse(abs(b1)>0.15,b1,0)
data <- data.frame(toy,eta1=eta1)
head(data)
ggplot(data,aes(x=d1,y=d2))+
geom_point(size=1,color=eta)
ggplot(data,aes(x=d1,y=d2))+
geom_point(size=1,color=eta1)
min(data$eta1)
ggplot(data,aes(x=d1,y=d2))+
geom_point(size=1,fill=eta1)
ggplot(data,aes(x=d1,y=d2))+
geom_point(fill=eta1)
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(fill=eta1))
data <- data.frame(toy,eta1=eta1)
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(fill=eta1,size=0.1))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1,size=0.01))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1,size=0.001))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=0.001)
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=0.001)+
theme_classic()
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=0.001)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1,size=eta1),size=0.001)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
eta1
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1/100)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1/20)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
sum(eta1>0)
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1/20)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1/10)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1/10,alpha=0.8)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1/10,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
data <- data.frame(toy,eta1=eta1)
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1/10,alpha=0.7)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=log(eta1),alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1/5,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1/5,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1/5,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=eta1,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(leta1=log(eta1))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=leta1,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(leta1=log(eta1+1)+0.01)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=leta1,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(leta1=log(eta1+1)+0.01)
head(data)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=leta1,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.01)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=logeta1,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
pdf("Results/eta_plot.pdf")
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.01)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=logeta1,alpha=0.7)
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.01)
head(data)
max(eta1)
max(logeta1)
max(data$logeta1)
max(data$eta1)
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.01)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=logeta1),alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.01)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=logeta1),size=logeta1,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.01)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=logeta1),size=eta1,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.01)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=logeta1),size=log(eta1+1)+0.01,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.01)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=logeta1),size=log(eta1+1)+0.01,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(3))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.01)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=logeta1),size=log(eta1+1)+0.01,alpha=0.7)+
#theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.01)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=logeta1),size=log(eta1+1)+0.01,alpha=0.7)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.005)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=logeta1),size=log(eta1+1)+0.01,alpha=0.7)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.005)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=logeta1),size=log(eta1+1)+0.01,alpha=0.7)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))+
+ guides(fill=guide_legend("Leta"))
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.005)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=log(eta1+1)+0.01,alpha=0.7)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.005)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=log(eta1+1)+0.01,alpha=0.7)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(5))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.005)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=log(eta1+1)+0.01,alpha=0.7)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(10))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.005)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=eta1),size=log(eta1+1)+0.01,alpha=0.7)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(3))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.005)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(size=log(eta1+1)+0.01,alpha=0.7)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(3))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%mutate(logeta1=log(eta1+1)+0.005)
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(size=log(eta1+1)+0.01,alpha=0.5)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(3))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf")
print(pp)
dev.off()
pdf("Results/eta_plot.pdf",height=5,width=5)
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%
mutate(logeta1=log(eta1+1)+0.005,
etac=ifelse(eta1==0,"NULL","Alternative"))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac),size=log(eta1+1)+0.01,alpha=0.5)+
theme_classic()+
scale_colour_gradientn(colours = terrain.colors(3))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf",height=5,width=5)
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%
mutate(logeta1=log(eta1+1)+0.005,
etac=ifelse(eta1==0,"NULL","Alternative"))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac),size=log(eta1+1)+0.01,alpha=0.5)+
theme_classic()
#+scale_colour_gradientn(colours = terrain.colors(3))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf",height=5,width=5)
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%
mutate(logeta1=log(log(eta1+1))+0.005,
etac=ifelse(eta1==0,"NULL","Alternative"))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac),size=log(eta1+1)+0.01,alpha=0.5)+
theme_classic()
#+scale_colour_gradientn(colours = terrain.colors(3))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf",height=5,width=5)
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%
mutate(logeta1=log(log(eta1+1))+0.005,
etac=ifelse(eta1==0,"NULL","Alternative"))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac),size=log(log(eta1+1))+0.01,alpha=0.5)+
theme_classic()
#+scale_colour_gradientn(colours = terrain.colors(3))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf",height=5,width=5)
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%
mutate(logeta1=log(log(eta1+1))+0.005,
etac=ifelse(eta1==0,"NULL","Alternative"))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac),size=log(eta1+1)+0.01,alpha=0.5)+
theme_classic()
#+scale_colour_gradientn(colours = terrain.colors(3))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf",height=5,width=5)
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%
mutate(logeta1=log(log(eta1+1))+0.005,
etac=ifelse(eta1==0,"NULL","Alternative"))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac),size=log(eta1+1)+0.01,alpha=0.5)+
theme_classic()
#+scale_colour_gradientn(colours = terrain.colors(3))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf",height=3,width=5)
print(pp)
dev.off()
pdf("Results/eta_plot.pdf",height=3,width=4)
print(pp)
dev.off()
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%
mutate(logeta1=log(log(eta1+1))+0.005,
etac=ifelse(eta1==0,"NULL","Alternative"))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()
#+scale_colour_gradientn(colours = terrain.colors(3))
#+ labs(color = "Dose (mg)")
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%
mutate(logeta1=log(log(eta1+1))+0.005,
etac=ifelse(eta1==0,"NULL","Alternative"))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()
#+scale_colour_gradientn(colours = terrain.colors(3))
+ labs(size = "Log(eta)",color="Feature")
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()
#+scale_colour_gradientn(colours = terrain.colors(3))
+ labs(size = "Log(eta)")
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()
#+scale_colour_gradientn(colours = terrain.colors(3))
+ labs(fill = "Log(eta)")
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()  + labs(fill = "Log(eta)")
#+scale_colour_gradientn(colours = terrain.colors(3))
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()  + labs(fill = "Log(eta)",color="Feature")
#+scale_colour_gradientn(colours = terrain.colors(3))
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()  + labs(color = "Log(eta)",color="Feature")
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()  + labs(size = "Log(eta)",color="Feature")
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()+ labs(size = "Log(eta)",color="Feature")
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()+ labs(size = "Log(eta)",color="Feature")+
scale_size(range=c(0.1,4))
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()+ labs(size = "Log(eta)",color="Feature")+
scale_size(range=c(0.1,2))
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()+ labs(size = "Log(eta)",color="Feature")+
scale_size(range=c(0.01,2))
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()+ labs(size = "L-eta",color="Feature")+
scale_size(range=c(0.01,2))
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
data <- data.frame(toy,eta1=eta1)%>%
mutate(logeta1=log(log(eta1+1))+0.005,
etac=ifelse(eta1==0,"Null","Alternative"))
pp=ggplot(data,aes(x=d1,y=d2))+
geom_point(aes(color=etac,size=log(eta1+1)+0.01),alpha=0.5)+
theme_classic()+ labs(size = "L-eta",color="Feature")+
scale_size(range=c(0.01,2))
pdf("Results/eta_plot.pdf",height=2.5,width=4)
print(pp)
dev.off()
